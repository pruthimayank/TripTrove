<head>
    <title>Package</title>
</head>
{% extends 'base.html' %}

{% load static %}
{% block additional_css %}
<style>
    /* Container for the video background */
    .video-container {
        position: relative;
        height: 300vh; /* To cover both sections */
    }
    .video-container2 {
        position: relative;
        height: 100vh; /* To cover both sections */
    }

    /* Background video settings */
    #background-video {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1; /* Keep video behind everything */
    }

    .section {
        position: relative;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        text-align: center;
        z-index: 1; /* Ensure text is on top of video */
        overflow: hidden; /* Prevent overflow */
    }

    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0); /* Start with transparent */
        transition: background 0.5s ease;
        z-index: 0; /* Ensure it's behind the content */
    }

    h1, p {
        margin: 0;
        padding: 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .zoom {
        transition: transform 1s ease;
    }

    .section-bg {
        background-size: cover;
        background-position: center;
        height: 100vh; /* Full viewport height */
    }
</style>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&display=swap');
    .cinzel {
        font-family: "Cinzel", serif;
        font-optical-sizing: auto;
        font-weight: 500;
        font-style: normal;
    }
</style>
{% endblock %}

{% block content %}
    <main>
        <div class="video-container">
            <video autoplay muted loop id="background-video">
                <source src="{{package.video}}" type="video/mp4">
            </video>

            <div class="sectionvideo">
                <section class="section" id="city-name">
                    <div class="overlay"></div>
                    <div style="position: relative; z-index: 1; text-align: center;">
                        <h3 class="cinzel">{{package.description}}</h3>
                        <h1 style="transform: translateY(-15px); font-size: 16vh; font-family: serif; text-transform: uppercase;">
                            {{package.name}}
                        </h1>                        
                        <br>
                        <div class="w-100 text-center">
                            <div class="my-5">
                                <a href="/package/{{package.name}}/" class="mt-1 btn btn-outline-light rounded-5" style="width: 200px; text-decoration: none;">Book Now</a>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <div class="overlay"></div>
                    <div>
                        <h1 class="cinzel" style="font-size: 4rem;">A royal journey through <br> heritage</h1>
                    </div>
                </section>
    
                <section class="section">
                    <div class="overlay"></div>
                    <div class="position-relative row mx-0" style="z-index: 1;">
                        <div class="col-md-6">
                            <h1 class="cinzel mt-2" style="font-size: 2.7rem;">{{package.description}}</h1>
                        </div>
                        <div class="col-md-4 text-start">
                            <p style="font-size: x-large;">{{package.details}}</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <div>
            {% for itinerary in package.itineraries %}
                <section class="normal-section border-bottom" style="overflow: hidden;">
                    {% if itinerary.image %}
                        <div class="row justify-content-center align-items-center h-100 section-bg zoom" 
                             style="background-image: url('{{ itinerary.image }}');">
                        </div>
                    {% elif itinerary.video %}
                        <div style="position: relative; height: 100vh;">
                            <video autoplay loop muted style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1;">
                                <source src="{{ itinerary.video }}" type="video/mp4">
                            </video>
                            <div class="row justify-content-center align-items-center h-100" style="position: relative; z-index: 1;">
                                <!-- text over video -->
                            </div>
                        </div>
                    {% else %}
                        <div class="row justify-content-center align-items-center h-100 section-bg zoom" style="background-image: url('https://picsum.photos/800/400');">
                            <div class="col text-center">
                                <h1>No media available</h1>
                            </div>
                        </div>
                    {% endif %}
                </section>
                
                <section style="height: 100vh; background-color: #141414;" class="d-flex flex-column align-items-center justify-content-center">
                    <div style="position: relative; z-index: 1; text-align: center;">
                        <h1 style="transform: translateY(-15px); font-size: 8vh; font-family: serif;">{{ itinerary.title }}</h1>
                        <h4 class="cinzel mx-4">{{ itinerary.description }}</h4>
                    </div>
                </section>
            {% empty %}
                <section class="normal-section border-bottom" style="overflow: hidden;">
                    <div class="row justify-content-center align-items-center h-100 section-bg zoom" style="background-image: url('https://picsum.photos/800/400');">
                        <div class="col text-center">
                            <h1>No itineraries available</h1>
                        </div>
                    </div>
                </section>
            {% endfor %}
        </div>              
    </main>
{% endblock %}

{% block additional_js %}
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script>
        window.addEventListener('scroll', function() {
            const overlayElements = document.querySelectorAll('.sectionvideo');
            
            overlayElements.forEach((overlay, index) => {
                const scrollY = window.scrollY;
                const sectionHeight = window.innerHeight; // height of the viewport
                const maxScroll = sectionHeight * (index + 1);

                // Calculate the opacity based on scroll position
                let opacity = 0.2; // Default opacity

                if (scrollY > maxScroll) {
                    // Increase opacity as you scroll down
                    opacity += (scrollY - maxScroll) / (sectionHeight * 0.5); // Adjust divisor for speed
                }
                opacity = Math.min(opacity, 0.8); // Cap the max opacity at 0.6
                
                overlay.style.background = `rgba(0, 0, 0, ${opacity})`;
            });
        });
    </script>

    
{% endblock %}  
